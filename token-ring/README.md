Задание 4.2

MainApp - основной класс. Результат работы пишется в файл "logsRing.txt". 

RingProcessor - в данном классе происходит запуск кольца, отправка данных и сбор статистики. В методе init() создаются все узлы и выбирается координатор. Для каждого узла указываем следующий узел в кольце (координатор при этом пропускаем) и узел, являющийся координатором (чтобы ему отправлять данные). Кроме того, генерируются данные. Изначально они равномерно распределяются по узлам кольца. В методе startProcessing() происходит запуск работы кольца. Методы countAverageNetworkDelay() и countAverageBufferDelay() отвечают за сбор статистики и ее запись в логи.

DataPackage - это класс пакета данных.

Node - класс узла кольца. При попадании на узел, данные кладутся в буфер. При этом для пакета данных записывается время последнего добавления в буфер (поскольку нужно будет посчитать среднее время нахождения в буфере). Для работы также используется DataCounter - класс, отвечающй за подсчет доставленных данных. Узлы кольца работают до тех пор, пока все данные не были доставлены. Для узла рассматривается число numPackages - сколько в данный момент обрабатывается пакетов данных на этом узле. Далее, если буфер не пустой, а данных обрабатывается меньше 3 (проверка за счет compareAndSet - чтобы не было некорректной ситуации с 4 и более обработками), то начинаем обработку данных. Убираем их из буфера (увеличивая при этом время нахождения в буфере для данного пакета данных). А далее, в зависимости от пункта назначения пакета, либо передаем его на следующий узел, либо обрабатываем у себя, отправляя на координатор.

В логах есть информация как о средней задержке в сети, так и о средней задержке в буфере. В среднем, значение средней задержки в буфере ненамного меньше значения общей средней задержки в сети, таким образом большую часть времени данные проводят именно в буфере. К примеру, при локальном запуске при 14 узлах и 255 пакетах данных значения вышли следующие:

Средняя задержка в сети = 142,667 ms

Средняя задержка в буфере = 132,73 ms

При запуске на gitlab значения немного поменялись, но общая тенденция сохранилась. 